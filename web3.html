<!DOCTYPE html>
<html>
    <head>
        <title>Web3 Generator</title>
        <!--<script src="https://cdn.ethers.io/lib/ethers-5.6.umd.min.js" type="text/javascript"></script>-->
        <script src="https://unpkg.com/aptos@latest/dist/index.global.js"></script>
        </head>
    <body>
        <div class="wrapper">
            <input type="slider" min="1" max="10" step="1" value="1" name="count">
            <label for="count">Apt amount to send</label>
            <input id='ok' type="button" value="Generate wallet">
            <pre id="out" user-select="all" onClick="navigator.clipboard.writeText(this.innerText)"></pre>
        </div>
        <script>
            let out = document.querySelector('#out');
            //let web3 = new Web3();
            document.addEventListener('DOMContentLoaded',(event) => {
               window.martian.connect();
                document.querySelector('#ok').addEventListener('click',async ()=>{
                    let accounts = Array(1).fill('').map(x=>new window.aptosSDK.AptosAccount());
                    console.log(accounts.map(x=>x.authKey().hexString));
                    out.innerText += '\n'+accounts.map(x=>x.authKey().hexString).join('\n');
                    if(await window.martian.isConnected()) {
                        if('Testnet' != (await window.martian.network())) alert('Most likely WRONG network');
                        accounts.map(async x=>{
                        // Create a transaction

const payload = {
    function: "0x1::aptos_account::transfer",
    type_arguments: [],
    arguments: [x.accountAddress.hexString, Number(document.querySelector('input').value)*100000000]
};
const transaction = await window.martian.generateTransaction(window.martian.address, payload);
const txnHash = await window.martian.signAndSubmitTransaction(transaction);
                    });
                }
                });
            });
        </script>
    </body>
</html>